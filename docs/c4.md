---
title: Архитектура
---

## Обоснование архитектуры

Архитектура системы адаптирована для достижения высокой производительности, масштабируемости и надёжности, с учётом необходимости работы с большим количеством взаимосвязанных данных. Для достижения 99.9% uptime выбран **Go** или **Kotlin** для серверной части. В качестве СУБД используется **PostgreSQL**, что позволяет хранить данные в нормализованной форме и эффективно управлять взаимосвязями между объектами.

1. **Модульная структура**:
   
    - Система разделена на независимые модули (заказы, меню, инвентаризация), что упрощает масштабирование и обновление.
   
2. **API-шлюзы**:

    - **Client API Gateway** обрабатывает запросы от мобильных приложений, веб-сайтов и терминалов, обеспечивая безопасность и аутентификацию.
    - **Internal API Gateway** взаимодействует с внешними системами (оплата, доставка, роботы) и управляет внутренними процессами.

3. **Кэширование**:
   
    - Использование **Redis** для ускорения доступа к часто запрашиваемым данным (например, меню), что снижает нагрузку на базу данных.

4. **Очереди сообщений (Kafka)**:
   
    - Асинхронная обработка данных через **Kafka** улучшает производительность и взаимодействие между модулями, особенно для управления роботами.

5. **Разделение баз данных**:
   
    - Каждая сущность (заказы, меню, клиенты, инвентарь) имеет свою собственную базу данных, что позволяет лучше управлять производительностью и безопасностью данных.

6. **Интеграция с внешними системами**:
   
    - Система взаимодействует с платёжными сервисами, службами доставки и системами управления роботами.

7. **Безопасность**:
   
    - Аутентификация и передача данных защищены через HTTPS.

8.  **Масштабируемость и отказоустойчивость**:
   
    - Система построена на контейнерах и облачных технологиях для обеспечения масштабируемости и отказоустойчивости.

## Диаграмма

![](diagrams/out/c3.svg)

## Описание компонентов

| №   | Тип                | Наименование           | Технологии         | Описание                                                                                   |
|-----|--------------------|------------------------|--------------------|--------------------------------------------------------------------------------------------|
| 1   | Мобильное/веб-приложение | Client Application   | iOS/Android/JavaScript | Приложение для клиентов, позволяющее заказывать блюда, оплачивать и отслеживать заказы.     |
| 2   | Терминал           | Terminal               | JavaScript         | Терминал самообслуживания для оформления заказов и оплаты.                                 |
| 3   | Веб-приложение     | Service Web            | JavaScript         | Интерфейс для сотрудников для управления меню, заказами и роботами.                        |
| 4   | Компонент          | Order Tableau          | JavaScript         | Компонент отображения статуса заказов на экранах ресторана.                                |
| 5   | Шлюз API           | Client API Gateway     | Go/Kotlin          | API шлюз для обработки запросов от клиентских приложений и терминалов.                     |
| 6   | Шлюз API           | Internal API Gateway   | Go/Kotlin          | Внутренний шлюз для интеграции систем и внешних сервисов.                                  |
| 7   | Компонент безопасности | Auth Component        | Go/Kotlin          | Аутентификация и авторизация пользователей и сотрудников.                                  |
| 8   | Бизнес-логика      | Orders Component       | Go/Kotlin          | Логика обработки заказов, их создание, изменение и управление статусами.                   |
|9   | Бизнес-логика      | Menu Component         | Go/Kotlin          | Управление меню ресторана, включая технологические карты.                                  |
| 10  | Бизнес-логика      | Clients Component      | Go/Kotlin          | Логика работы с клиентами, хранение данных о клиентах и программа лояльности.              |
| 11  | Бизнес-логика      | Robots Component       | Go/Kotlin          | Управление роботами и мониторинг их состояния.                                             |
| 12  | Бизнес-логика      | Inventory Component    | Go/Kotlin          | Управление запасами, автозаказы при снижении запасов.                                      |
| 13  | Очередь сообщений  | Broker (Kafka)         | Apache Kafka       | Асинхронная обработка сообщений между компонентами и внешними системами.                   |
| 14  | Кэш данных         | Cache Layer (Redis)    | Redis              | Кэширование данных для уменьшения задержек в работе системы.                              |
| 15  | СУБД               | Orders DB              | Postgres           | База данных для хранения заказов.                                                          |
| 16  | СУБД               | Menu DB                | Postgres           | База данных для хранения данных меню и технологических карт.                               |
| 17  | СУБД               | Clients DB             | Postgres           | База данных для хранения данных клиентов и программы лояльности.                           |
| 18  | СУБД               | Inventory DB           | Postgres           | База данных для хранения данных о запасах и автозаказах.                                   |
| 19  | СУБД               | Robots DB              | Postgres           | База данных для хранения данных о роботах и их состоянии.                                  |
| 20    | Внешняя система | Bank Processing            | Внешняя система    | Процессинг оплаты заказов через банковские системы.                                                 |
| 21    | Внешняя система | Я.Доставка                 | Внешняя система    | Система доставки заказов до клиента через партнёрские службы доставки.                              |
| 22    | Внешняя система | 1С Бухгалтерия             | Внешняя система    | Система управления складом и бухгалтерией, интегрированная с рестораном для учёта затрат.           |
| 23    | Внешняя система | Robots External System     | Внешняя система    | Внешняя система управления и мониторинга роботов, интегрированная с ресторанной системой.           |